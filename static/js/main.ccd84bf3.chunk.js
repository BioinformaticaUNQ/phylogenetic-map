(this["webpackJsonpphylogenetic-map"]=this["webpackJsonpphylogenetic-map"]||[]).push([[0],{175:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},246:function(e,t,n){},247:function(e,t,n){},248:function(e,t,n){},250:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(31),r=n.n(o),l=n(1),i=n(8),s=n(21),m=n.n(s),u=(n(94),n(32)),f=n(74),d=n.n(f),p=n(75),g=n.n(p),h=n(76),b=n.n(h),v=(n(175),function(e){var t=e.showInfo,n=e.restart,a=Object(l.e)((function(e){return e.files})),o=a.treefile,r=a.locations;return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"iconContainer",onClick:t&&n},c.a.createElement("img",{src:b.a,alt:"icon",className:"icon"}),c.a.createElement("p",{className:"text"},"Phylogenetic Map!")),t&&c.a.createElement("div",{className:"files"},c.a.createElement("p",{className:"text"},"Treefile: ",o.name),c.a.createElement("p",{className:"text"},"Location: ",r.name)))}),E=n(3),y=n(86),O=n(79),N=n(80),j=n.n(N),S=function(e){return Promise.all(e.map((function(e){return j.a.get("https://api.opencagedata.com/geocode/v1/json?key=".concat("b4ec1cf9ef564381871d4386e2133a63","&q=").concat(e.name)).then((function(e){return e.data})).then((function(t){var n=t.results[0].geometry,a=n.lat,c=n.lng;return Object(E.a)(Object(E.a)({},e),{},{latitude:a,longitude:c})}))})))},w="M9,0C4.029,0,0,4.029,0,9s4.029,9,9,9s9-4.029,9-9S13.971,0,9,0z M9,15.93 c-3.83,0-6.93-3.1-6.93-6.93S5.17,2.07,9,2.07s6.93,3.1,6.93,6.93S12.83,15.93,9,15.93 M12.5,9c0,1.933-1.567,3.5-3.5,3.5S5.5,10.933,5.5,9S7.067,5.5,9,5.5 S12.5,7.067,12.5,9z",C=n(81),k=n.n(C),M=n(82),F=n.n(M),q=(n(203),function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}),T=function(e){var t=e.filetreeName,n=e.locationContent,o=e.handleToogleModal,r=Object(a.useState)([]),l=Object(i.a)(r,2),s=l[0],m=l[1];Object(a.useEffect)((function(){var e;S((e=n,(e||[]).reduce((function(e,t){var n=e.findIndex((function(e){return e.name===t.name}));return-1!==n?(e[n].displaySeq="".concat(e[n].displaySeq,"\n").concat(t.seq),e[n].amountOfSeq+=1,e):[].concat(Object(y.a)(e),[{name:t.name,displaySeq:t.seq,amountOfSeq:1}])}),[]))).then((function(e){return e.map((function(e){return Object(E.a)(Object(E.a)({},e),{},{targetSVG:w,fill:q(),scale:.5*e.amountOfSeq})}))})).then(m)}),[n]),Object(a.useEffect)((function(){var e=window,t=e.am4core,n=e.am4maps,a=e.am4geodata_worldLow;t.useTheme((function(e){e instanceof n.MapPolygon&&(e.fill=t.color("#7fb5b0"))}));var c=t.create("chartdiv",n.MapChart);c.geodata=a,c.projection=new n.projections.Mercator,c.zoomControl=new n.ZoomControl,c.homeGeoPoint={latitude:51,longitude:-23};var o=c.series.push(new n.MapPolygonSeries);o.exclude=["AQ"],o.useGeodata=!0,o.mapPolygons.template.nonScalingStroke=!0;var r=c.series.push(new n.MapImageSeries),l=r.mapImages.template;l.tooltipText="{name}\n{displaySeq}",l.nonScaling=!0;var i=l.createChild(t.Sprite);i.path=w,i.horizontalCenter="middle",i.verticalCenter="middle",i.propertyFields.scale="scale",i.propertyFields.fill="fill",l.propertyFields.latitude="latitude",l.propertyFields.longitude="longitude",r.data=s,c.legend=new n.Legend,c.legend.paddingLeft=10,c.legend.paddingRight=10,c.legend.marginBottom=15,c.legend.width=t.percent(40),c.legend.valign="bottom",c.legend.contentAlign="left",c.legend.labels.template.fill=t.color("#fff");var m=s.map((function(e){return Object(E.a)(Object(E.a)({},e),{},{name:"".concat(e.name," \u2022 ").concat(e.amountOfSeq)})}));m.sort((function(e,t){return e.amountOfSeq-t.amountOfSeq})),c.legend.data=m,c.legend.itemContainers.template.interactionsEnabled=!1}),[s]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"chartdiv",className:"map"}),c.a.createElement("div",{className:"button-tree",onClick:function(){return o(!0)}},c.a.createElement("img",{src:k.a,alt:"phylogeneticTree",className:"icon"})),c.a.createElement("div",{className:"button-download-map",onClick:function(){Object(O.save)(document.querySelector("#chartdiv div").innerHTML.split("<div")[0],"".concat(t,".svg"))}},c.a.createElement("img",{src:F.a,alt:"downloadMap",className:"icon"})))},x=(n(204),n(83)),P=n.n(x),_=(n(238),n(84)),L=n.n(_);n(243);var B=function(e){var t=e.newick,n=m.a.parse_newick(t),o=Object(a.useRef)(null);return function e(t){t.children.forEach((function(t,n){if(t.name){var a=t.name.match("gi_(.*)_.*_(.*)_");a?(t.gi="Gi: ".concat(a[1]),t.gb=a[2]):(t.gi=t.name,t.gb=t.name)}t.displayName=t.name?t.gi:t.branch_length,t.key="".concat(n,"-").concat(t.displayName),t.children&&e(t)}))}(n),Object(a.useEffect)((function(){if(o.current){var e=document.querySelector("#phylogeneticTreeContainer svg");L()(e,{dblClickZoomEnabled:!1})}}),[o]),c.a.createElement("div",{className:"phylogeneticTreeContainer",id:"phylogeneticTreeContainer"},c.a.createElement(P.a,{ref:o,data:n,height:2e3,width:2e3,labelProp:"displayName",keyProp:"key"}))},I=function(e){var t=e.filetreeContent,n=e.closeModal;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"modalBackground",onClick:n}),c.a.createElement("div",{className:"modalContent"},c.a.createElement(B,{newick:t})))},A=(n(244),function(){var e=Object(l.e)((function(e){return e.files})),t=e.treefile,n=e.locations,o=Object(a.useState)(!1),r=Object(i.a)(o,2),s=r[0],m=r[1];return c.a.createElement("div",{className:"mainContainer"},c.a.createElement(T,{filetreeName:t.name,locationContent:JSON.parse(n.content),handleToogleModal:function(e){return m(e)}}),s&&c.a.createElement(I,{filetreeContent:t.content,closeModal:function(){return m(!1)}}))}),G=(n(245),function(e){var t=e.value,n=e.label,o=e.placeholder,r=void 0===o?"Select file":o,l=e.htmlFor,i=e.accept,s=e.onChange,m=Object(a.useRef)(null);return c.a.createElement("div",{className:"formRow ".concat(t&&"selectedFile")},c.a.createElement("label",{htmlFor:l,className:"label"},n,": ",t||r),c.a.createElement("span",{htmlFor:l,className:"btn btnUpload",onClick:function(){return m.current&&m.current.click()}},"Upload"),c.a.createElement("input",{id:l,type:"file",ref:m,className:"inputFile",accept:i,onChange:s}))}),J=function(e){var t=e.generateMap,n=Object(l.e)((function(e){return e.files})),a=n.treefile,o=n.locations,r=Object(l.d)((function(e){return e.files})),i=r.addTreefile,s=r.addLocations,m=function(e){return function(t){if(t.target.files.length){var n=t.target.files[0],a=new FileReader;a.onload=function(t){return e({name:n.name,content:t.target.result})},a.readAsText(n)}}},u=m(i),f=m(s);return c.a.createElement("div",{className:"form"},c.a.createElement(G,{value:a.name,htmlFor:"treefile",label:"Treefile",onChange:u,accept:".treefile"}),c.a.createElement(G,{value:o.name,htmlFor:"location",label:"Location",onChange:f,accept:".json"}),c.a.createElement("span",{className:"btn btnPrimary ".concat((!a.name||!o.name)&&"btn-disabled"),onClick:t},"Generate Map"))},R=n(85),z=n.n(R),D=(n(246),function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("a",{href:"https://github.com/hurrell-y-mottesi/phylogenetic-map",className:"link"},c.a.createElement("img",{src:z.a,alt:"github",className:"icon"})),"Hurrell Tomas and Mottesi Juan")}),H=(n(247),function(e){return u.NotificationManager.error(["".concat(e," format is incorrect"),c.a.createElement("a",{className:"link",href:"https://github.com/hurrell-y-mottesi/phylogenetic-map",target:"_blank",rel:"noopener noreferrer"},"Show Doc")],"",5e5)});var U=function(){var e=Object(l.e)((function(e){return e.files})),t=e.treefile,n=e.locations,o=Object(l.d)((function(e){return e.files.cleanFiles})),r=Object(a.useState)(!1),s=Object(i.a)(r,2),f=s[0],p=s[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"container"},c.a.createElement(v,{showInfo:f,restart:function(){o(),p(!1)}}),f?c.a.createElement(A,{goBack:function(){return p(!1)}}):c.a.createElement(J,{generateMap:function(){var e=m.a.parse_newick(t.content);if(g()(e))H(t.name);else try{var a=JSON.parse(n.content);a instanceof Array&&!a.some((function(e){return 0!==d()(Object.keys(e),["seq","name"]).length}))?p(!0):H(n.name)}catch(c){H(n.name)}}}),c.a.createElement(D,null)),c.a.createElement(u.NotificationContainer,null))},W=Object(l.c)({files:{treefile:{name:"",content:""},locations:{name:"",content:""},addTreefile:Object(l.b)((function(e,t){e.treefile=Object(E.a)({},t)})),addLocations:Object(l.b)((function(e,t){var n=t.name,a=t.content;e.locations={name:n,content:a}})),cleanFiles:Object(l.b)((function(e){e.treefile={name:"",content:""},e.locations={name:"",content:""}}))}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(248);r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(l.a,{store:W},c.a.createElement(U,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},76:function(e,t,n){e.exports=n.p+"static/media/icon.67a5203a.svg"},81:function(e,t,n){e.exports=n.p+"static/media/tree.db21f93f.svg"},82:function(e,t,n){e.exports=n.p+"static/media/downloadMap.abd052bd.svg"},85:function(e,t,n){e.exports=n.p+"static/media/github.76d344f0.svg"},87:function(e,t,n){e.exports=n(250)}},[[87,1,2]]]);
//# sourceMappingURL=main.ccd84bf3.chunk.js.map
(this["webpackJsonpphylogenetic-map"]=this["webpackJsonpphylogenetic-map"]||[]).push([[0],{134:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},141:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(42),r=n.n(o),l=n(1),i=n(5),s=n(43),m=n.n(s),u=(n(60),function(e){var t=e.showInfo,n=e.restart,a=Object(l.e)((function(e){return e.files})),o=a.treefile,r=a.locations;return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"iconContainer",onClick:n},c.a.createElement("img",{src:m.a,alt:"icon",className:"icon"}),c.a.createElement("p",{className:"text"},"Phylogenetic Map!")),t&&c.a.createElement("div",{className:"files"},c.a.createElement("p",{className:"text"},"Treefile: ",o.name),c.a.createElement("p",{className:"text"},"Location: ",r.name)))}),d=n(3),f=n(54),p=n(46),g=n(47),h=n.n(g),b=function(e){return Promise.all(e.map((function(e){return h.a.get("https://api.opencagedata.com/geocode/v1/json?key=".concat("b4ec1cf9ef564381871d4386e2133a63","&q=").concat(e.name)).then((function(e){return e.data})).then((function(t){var n=t.results[0].geometry,a=n.lat,c=n.lng;return Object(d.a)(Object(d.a)({},e),{},{latitude:a,longitude:c})}))})))},v="M9,0C4.029,0,0,4.029,0,9s4.029,9,9,9s9-4.029,9-9S13.971,0,9,0z M9,15.93 c-3.83,0-6.93-3.1-6.93-6.93S5.17,2.07,9,2.07s6.93,3.1,6.93,6.93S12.83,15.93,9,15.93 M12.5,9c0,1.933-1.567,3.5-3.5,3.5S5.5,10.933,5.5,9S7.067,5.5,9,5.5 S12.5,7.067,12.5,9z",E=n(48),O=n.n(E),j=n(49),y=n.n(j),N=(n(88),function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}),S=function(e){var t=e.filetreeName,n=e.locationContent,o=e.handleToogleModal,r=Object(a.useState)([]),l=Object(i.a)(r,2),s=l[0],m=l[1];Object(a.useEffect)((function(){var e;b((e=n,(e||[]).reduce((function(e,t){var n=e.findIndex((function(e){return e.name===t.name}));return-1!==n?(e[n].displaySeq="".concat(e[n].displaySeq,"\n").concat(t.seq),e[n].amountOfSeq+=1,e):[].concat(Object(f.a)(e),[{name:t.name,displaySeq:t.seq,amountOfSeq:1}])}),[]))).then((function(e){return e.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{targetSVG:v,fill:N(),scale:.5*e.amountOfSeq})}))})).then(m)}),[n]),Object(a.useEffect)((function(){var e=window,t=e.am4core,n=e.am4maps,a=e.am4geodata_worldLow;t.useTheme((function(e){e instanceof n.MapPolygon&&(e.fill=t.color("#7fb5b0"))}));var c=t.create("chartdiv",n.MapChart);c.geodata=a,c.projection=new n.projections.Mercator,c.zoomControl=new n.ZoomControl,c.homeGeoPoint={latitude:51,longitude:-23};var o=c.series.push(new n.MapPolygonSeries);o.exclude=["AQ"],o.useGeodata=!0,o.mapPolygons.template.nonScalingStroke=!0;var r=c.series.push(new n.MapImageSeries),l=r.mapImages.template;l.tooltipText="{name}\n{displaySeq}",l.nonScaling=!0;var i=l.createChild(t.Sprite);i.path=v,i.horizontalCenter="middle",i.verticalCenter="middle",i.propertyFields.scale="scale",i.propertyFields.fill="fill",l.propertyFields.latitude="latitude",l.propertyFields.longitude="longitude",r.data=s,c.legend=new n.Legend,c.legend.paddingLeft=10,c.legend.paddingRight=10,c.legend.marginBottom=15,c.legend.width=t.percent(40),c.legend.valign="bottom",c.legend.contentAlign="left";var m=s.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{name:"".concat(e.name," \u2022 ").concat(e.amountOfSeq)})}));m.sort((function(e,t){return e.amountOfSeq-t.amountOfSeq})),c.legend.data=m,c.legend.itemContainers.template.interactionsEnabled=!1}),[s]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"chartdiv",className:"map"}),c.a.createElement("div",{className:"button-tree",onClick:function(){return o(!0)}},c.a.createElement("img",{src:O.a,alt:"phylogeneticTree",className:"icon"})),c.a.createElement("div",{className:"button-download-map",onClick:function(){Object(p.save)(document.querySelector("#chartdiv div").innerHTML.split("<div")[0],"".concat(t,".svg"))}},c.a.createElement("img",{src:y.a,alt:"downloadMap",className:"icon"})))},C=(n(89),function(e){e.errors;return c.a.createElement("div",{className:"footer"})}),w=(n(90),n(50)),k=n.n(w),M=n(51),F=n.n(M),q=(n(129),n(52)),T=n.n(q);n(134);var x=function(e){var t=e.newick,n=k.a.parse_newick(t),o=Object(a.useRef)(null);return function e(t){t.children.forEach((function(t,n){if(t.name){var a=t.name.match("gi_(.*)_.*_(.*)_");a?(t.gi="Gi: ".concat(a[1]),t.gb=a[2]):(t.gi=t.name,t.gb=t.name)}t.displayName=t.name?t.gi:t.branch_length,t.key="".concat(n,"-").concat(t.displayName),t.children&&e(t)}))}(n),Object(a.useEffect)((function(){if(o.current){var e=document.querySelector("#phylogeneticTreeContainer svg");T()(e,{dblClickZoomEnabled:!1})}}),[o]),c.a.createElement("div",{className:"phylogeneticTreeContainer",id:"phylogeneticTreeContainer"},c.a.createElement(F.a,{ref:o,data:n,height:2e3,width:2e3,labelProp:"displayName",keyProp:"key"}))},P=function(e){var t=e.filetreeContent,n=e.closeModal;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"modalBackground",onClick:n}),c.a.createElement("div",{className:"modalContent"},c.a.createElement(x,{newick:t})))},B=(n(135),function(e){var t=e.goBack,n=Object(l.e)((function(e){return e.files})),o=n.treefile,r=n.locations,s=Object(a.useState)(!1),m=Object(i.a)(s,2),u=m[0],d=m[1],f=Object(a.useState)([]),p=Object(i.a)(f,2),g=p[0],h=p[1];return Object(a.useEffect)((function(){h((o.content,r.content,[]))}),[o,r]),g.length?c.a.createElement(C,{errors:g,goBack:t}):c.a.createElement("div",{className:"mainContainer"},c.a.createElement(S,{filetreeName:o.name,locationContent:r.content,handleToogleModal:function(e){return d(e)}}),u&&c.a.createElement(P,{filetreeContent:o.content,closeModal:function(){return d(!1)}}))}),L=(n(136),function(e){var t=e.value,n=e.label,o=e.placeholder,r=void 0===o?"Select file":o,l=e.htmlFor,i=e.accept,s=e.onChange,m=Object(a.useRef)(null);return c.a.createElement("div",{className:"formRow ".concat(t&&"selectedFile")},c.a.createElement("label",{htmlFor:l,className:"label"},n,": ",t||r),c.a.createElement("span",{htmlFor:l,className:"btn btnUpload",onClick:function(){return m.current&&m.current.click()}},"Upload"),c.a.createElement("input",{id:l,type:"file",ref:m,className:"inputFile",accept:i,onChange:s}))}),_=function(e){var t=e.generateMap,n=Object(l.e)((function(e){return e.files})),a=n.treefile,o=n.locations,r=Object(l.d)((function(e){return e.files})),i=r.addTreefile,s=r.addLocations,m=function(e){return function(t){if(t.target.files.length){var n=t.target.files[0],a=new FileReader;a.onload=function(t){return e({name:n.name,content:t.target.result})},a.readAsText(n)}}},u=m(i),d=m(s);return c.a.createElement("div",{className:"form"},c.a.createElement(L,{value:a.name,htmlFor:"treefile",label:"Treefile",onChange:u,accept:".treefile"}),c.a.createElement(L,{value:o.name,htmlFor:"location",label:"Location",onChange:d,accept:".json"}),c.a.createElement("span",{className:"btn btnPrimary ".concat((!a.name||!o.name)&&"btn-disabled"),onClick:t},"Generate Map"))},I=n(53),G=n.n(I),R=(n(137),function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("a",{href:"https://github.com/hurrell-y-mottesi/phylogenetic-map",className:"link"},c.a.createElement("img",{src:G.a,alt:"github",className:"icon"})),"Hurrell Tomas and Mottesi Juan")});n(138);var z=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],o=t[1],r=Object(l.d)((function(e){return e.files.cleanFiles}));return c.a.createElement("section",{className:"container"},c.a.createElement(u,{showInfo:n,restart:function(){r(),o(!1)}}),n?c.a.createElement(B,{goBack:function(){return o(!1)}}):c.a.createElement(_,{generateMap:function(){return o(!0)}}),c.a.createElement(R,null))},A=Object(l.c)({files:{treefile:{name:"",content:""},locations:{name:"",content:""},addTreefile:Object(l.b)((function(e,t){e.treefile=Object(d.a)({},t)})),addLocations:Object(l.b)((function(e,t){var n=t.name,a=t.content;e.locations={name:n,content:JSON.parse(a)}})),cleanFiles:Object(l.b)((function(e){e.treefile={name:"",content:""},e.locations={name:"",content:""}}))}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(139);r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(l.a,{store:A},c.a.createElement(z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},43:function(e,t,n){e.exports=n.p+"static/media/icon.67a5203a.svg"},48:function(e,t,n){e.exports=n.p+"static/media/tree.db21f93f.svg"},49:function(e,t,n){e.exports=n.p+"static/media/downloadMap.abd052bd.svg"},53:function(e,t,n){e.exports=n.p+"static/media/github.76d344f0.svg"},55:function(e,t,n){e.exports=n(141)},60:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){}},[[55,1,2]]]);
//# sourceMappingURL=main.5476a3bd.chunk.js.map